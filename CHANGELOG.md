# Changelog

Все значимые изменения в проекте будут документироваться в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

## [Unreleased]

### Добавлено
- Git hooks для автоматической проверки кода перед коммитом
  - Pre-commit hook для запуска тестов и линтера
  - Автоматическая проверка Deno проектов (lint, type check, tests)
  - Автоматическая проверка компиляции Kotlin проекта
  - Скрипты установки hooks для разных платформ (sh, bat, js)
  - Автоматическая установка через npm postinstall скрипт
  - Документация по настройке и использованию (GIT_HOOKS.md)

### Планируется
- Реализация polling механизма для мониторинга изменений
- Реализация connection-handler для подключения к целевым серверам
- Реализация StorageProvider для CALLER (Deno и Android)
- Интеграция CALLER с облачным хранилищем через StorageProvider
- Тестирование интеграции между LISTENER и CALLER

## [0.1.0] - 2025-11-22

### Добавлено
- Базовая структура монорепозитория
- Архитектурная документация (ARCHITECTURE.md)
- Описание протокола передачи данных через файлы (shared/protocol/PROTOCOL.md)
- TypeScript типы для протокола (shared/protocol/types.ts)
- Базовая структура LISTENER для Яндекс Диск (listeners/yandex-disk/)
- Базовая структура CALLER для Android (callers/android/)
  - SOCKS5 сервер (Socks5Server.kt)
  - SOCKS5 обработчик протокола (Socks5Handler.kt)
  - Абстракция ConnectionHandler (ConnectionHandler.kt)
  - Базовая реализация DefaultConnectionHandler (DefaultConnectionHandler.kt)
- Базовая структура CALLER для Deno (callers/deno/)
- README с описанием проекта и быстрым стартом

#### LISTENER для Яндекс Диск
- Полная реализация StorageProvider для Яндекс Диск API
  - Модульная архитектура (storage-provider/ с разделением на типы, ошибки, утилиты, HTTP клиент, операции с файлами)
  - Методы listFiles, downloadFile, uploadFile, deleteFile
  - Обработка OAuth аутентификации
  - Retry механизм с exponential backoff
  - Обработка rate limits (429) с поддержкой Retry-After заголовка
  - Обработка ошибок API с детальными сообщениями
- Настройка линтера Deno с рекомендуемыми правилами
- Комплексные юнит тесты (47 тестов)
  - Тесты для утилит (11 тестов)
  - Тесты для классов ошибок (3 теста)
  - Тесты для операций с файлами (8 тестов)
  - Тесты для HTTP клиента и retry логики (17 тестов)
  - Тесты для основного провайдера (8 тестов)
- Скрипты для проверки работоспособности
  - `scripts/verify-setup.ts` - проверка настройки без реального API
  - `scripts/check-health.ts` - полная проверка с реальным API
  - `scripts/get-token.ts` - помощь в получении OAuth токена
- Документация
  - `GETTING_TOKEN.md` - подробная инструкция по получению OAuth токена
  - `QUICK_START.md` - быстрый старт для получения токена
  - `CHECKING.md` - руководство по проверке работоспособности
  - Обновлен README с инструкциями по использованию

### Изменено
- Рефакторинг кода StorageProvider:
  - Разбиение большого файла на модульную структуру
  - Использование function declarations вместо const для функций
  - Разделение на мелкие функции для лучшей читаемости
  - Функциональный подход к организации кода

### Исправлено
- Исправлены ошибки типов в тестах
- Исправлена обработка Response body (клонирование для повторного чтения)
- Исправлена проверка URL параметров в тестах

